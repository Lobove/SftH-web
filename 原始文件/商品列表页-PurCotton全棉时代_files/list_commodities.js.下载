jQuery(document).ready(function($) {
	$('.goods-recommend').zy_slide({
		auto_time: 3000
	});

	$('.right-recommend-slide').zy_slide({
		show_num: 4,
		auto_time: 1500,
		slide_hover_stop: true
	});

	var left_w = $('.classify-comm>.wrap>.left:first').outerWidth();
	$('.classify-comm>.wrap>.left:last').css({
		width: (1100-left_w) + 'px'
	});
	
	//右边的按价格、上架时间等排列方式，控制当前点击的项增加高亮颜色
	$('.sort-order > a').click(function (){
		$this = $(this);
		$this.addClass('cur-sort').siblings('a').removeClass('cur-sort');;
	});
	
	pageNoClickForPCNew(1,"listCommPage"); // PC改版使用

});

// 点击切换页数滚动到商品列表顶部
function go_list_top () {
	var pro_list_top = $('.goods-area-wrap').offset().top-110;
	// $('#listCommPage a').click(function() {
	  $('body,html').animate({scrollTop:pro_list_top}, 500);
	// });
}

function pageNoClick(pageNo){ //分页获得数据
			
		var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	
		var queryWord = $("#queryWord").val();     //搜索的词
		
		var propertyType=""+$("#propertyType").val(); //属性类别
		var propertyFilters = propertyFiltersVal(propertyType);
		var priceScopes="";
	
		var minPrice=$("#minPrice").val();     //最小值
		var maxPrice=$("#maxPrice").val();     //最大值
		 var reg = /^([1-9]\d*|0)$/;
		 
		 if(null!=minPrice&&""!=minPrice){
			 if(!reg.test(minPrice)) {
				alertBox('最小值应为正整数');
				return ;
			 }
			 priceScopes="priceScopes[0].minPrice="+minPrice;
		}
		if(""!=maxPrice&&null!=maxPrice&&""!=minPrice){
			 if(!reg.test(maxPrice)) {
				 alertBox('最大值应为正整数');
				 return ;
			 }
			priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
		}	
		
		var salesTagNos=$("#salesTagNos").val();
		var url= MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
		var params='pageNo='+pageNo;
	
		if(null!=oprtCatNo&&""!=oprtCatNo){
			params = params +'&oprtCatNo=\"'+oprtCatNo+'\"';
		}
		if(null!=queryWord&&""!=queryWord){
			params = params +'&queryWord='+queryWord;
		}
		if(null!=propertyFilters&&""!=propertyFilters){
			params = params +'&'+propertyFilters;
		}
		if(null!=salesTagNos&&""!=salesTagNos){
			params = params +'&salesTagNos='+salesTagNos;
		}	
		if(""!=priceScopes){
			params = params+ '&'+priceScopes;
		}
		var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
		var orderType = $("#commodOrder").val();
		
		if(""!=orderType){ //排序方式
			params = params+'&prodSortField='+orderType;
			if(""!=sortType){
				params = params+'&sortType='+sortType;
			}
		}
		ajaxController(url,params);			    		    
}


/**
* 排序方式
 */
function commodOrder(orderType,aFiled){
	var propertyFilters = $("#commodOrder").val(); //排序方式
	if(""!=orderType)
	{ 
		//如果选中综合排序
		if(propertyFilters==orderType)
		{ 
			//当前点击的怕排序方式，跟上次相同，则不请求数据			
			var aSpan = $(aFiled).find("span");
			if(aSpan.hasClass("uparrow1"))
			{
				aSpan.removeClass("uparrow1").addClass("downarrow");
			}
			else
			{
				aSpan.removeClass("downarrow").addClass("uparrow1");
			}		
		}
		else
		{	
			$(".sub-pax .xl").find(".hover").removeClass("hover").find("span").removeClass("uparrow1").removeClass("downarrow").addClass("uparrow");  
			$(aFiled).addClass("hover");
			$(aFiled).find("span").removeClass("uparrow").addClass("uparrow1");
		}		
		var sortTyoe = $(aFiled).find("span").attr("class");
		if(sortTyoe=="uparrow1")
		{ 
			//降序
			$("#sortType").val("desc");
		}
		else
		{
			//升序
			$("#sortType").val("asc");
		}
	}
	else
	{
		$(".sub-pax .xl").find(".hover").removeClass("hover").find("span").removeClass("uparrow1").removeClass("downarrow").addClass("uparrow");  
		$(aFiled).addClass("hover");
		$(aFiled).find("span").removeClass("uparrow").addClass("uparrow1");	
		$("#sortType").val("");
	}	
	
	$("#commodOrder").val(orderType);
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var queryWord = $("#queryWord").val();     //搜索的词

	var prodPriceScope=$("#prodPriceScope").val(); //获取价格段
	var priceScopes= prodPriceScopeVal(prodPriceScope);
	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	var salesTagNos=$("#salesTagNos").val();
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var params='oprtCatNo='+oprtCatNo
			+'&queryWord='+queryWord+'&'+priceScopes+'&'+propertyFilters+"&salesTagNos="+salesTagNos;
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType)
	{ 
		//排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType)
		{
			params = params+'&sortType='+sortType;
		}
	}
	var priceScopes="";
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	var reg = /^([1-9]\d*|0)$/;
	if(null!=minPrice&&""!=minPrice)
	{
		if(!reg.test(minPrice))
		{
			alertBox('最小值应为正整数');
			return ;
		}
		priceScopes="priceScopes[0].minPrice="+minPrice;
	}
	
	if(null!=maxPrice&&""!=maxPrice&&""!=minPrice)
	{
		 if(!reg.test(maxPrice)) 
		 {
			 alertBox('最大值应为正整数');
			 return ;
		 }
		priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
	}
	
	if(""!=priceScopes)
	{
		params = params+ '&'+priceScopes;
	}
	ajaxController(url,params);		
}

function resltQuery(){ //重置查询条件
	$("#prodPriceScope").val(""); //获取价格段
	$("#propertyType").val(""); //属性值
	
	$("#minPrice").val("");     //最小值
	$("#maxPrice").val("");     //最大值

	resetSelection();
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var queryWord = $("#queryWord").val();     //搜索的词
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号

	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+"&salesTagNos="+salesTagNos;
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType)
	{
		params = params+'&prodSortField='+orderType;
		if(""!=sortType)
		{
			params = params+'&sortType='+sortType;
		}
	}
	
	ajaxController(url,params);		
}


function unlimitedPrice(obj){ //价格段不限制
	
	$(obj).addClass("hover ibg");
	
	$(this).parent().parent().find('.slir').removeClass('xzh');
	
	$(obj).parent().parent().find('.ensure-y').removeClass('ensure-yo');
	
	//$("#prodPriceScope").val(""); //价格段清空
	$("#minPrice").val("");     //最小值
	$("#maxPrice").val("");     //最大值

	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	//var salesTagNos=$("#salesTagNos").val();   //标签编号
	var queryWord = $("#queryWord").val();     //搜索的词
	//var prodPriceScope=$("#prodPriceScope").val(); //获取价格段
	//var priceScopes= prodPriceScopeVal(prodPriceScope);
	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='
		+queryWord+'&'+propertyFilters+'&salesTagNos='+salesTagNos;
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	ajaxController(url,params);		
	
}
function onSales(checkboxField){ //促销是否选中
	/*var onSales =false;
	if($(checkboxField).is(":checked")){//true
		onSales=true;
	}
	var orderType=$("#commodOrder").val();
	
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	
	var queryWord = $("#queryWord").val();     //搜索的词
	var prodPriceScope=$("#prodPriceScope").val(); //获取价格段
	var priceScopes= prodPriceScopeVal(prodPriceScope);
	
	var url='searchCommoByOrder.ihtml';	

	var params='oprtCatNo='+oprtCatNo+'prodSortField='+orderType+'&queryWord='
		+queryWord+'&'+priceScopes;
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	alertBox(params);
	ajaxController(url,params);		*/

}
function prodPriceClick(obj){ //点击价格段
	
	var priceScopes="";
	//$("#prodPriceScope").val(priceNo); //设置价格段
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	 var reg = /^([1-9]\d*|0)$/;
	 
	 if(null!=maxPrice||null!=minPrice){
		 if(""==minPrice){
			 alertBox('最小值不能为空!');
				return ;
		 }
		 if(""!=minPrice){
			 if(!reg.test(minPrice)) {
				alertBox('最小值应为正整数');
				return ;
			 }
			 priceScopes="priceScopes[0].minPrice="+minPrice;
		}
		if(null!=maxPrice&&""!=maxPrice&&""!=maxPrice){
			 if(!reg.test(maxPrice)) {
				 alertBox('最大值应为正整数');
				 return ;
			 }
			priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
		}	
	 }else{
		 alertBox('最小值不能为空!');
		 return ;
	 }
	
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var queryWord = $("#queryWord").val();     //搜索的词	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+propertyFilters+'&salesTagNos='+salesTagNos;
	if(""!=priceScopes){
		params = params+ '&'+priceScopes;
	}
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){ //排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	/**确定按钮上面添加样式*/
	$(obj).addClass("ensure-yo");
	
	/**去除不限上面的时间*/
	$(obj).parent().find('.dsib1 a').removeClass('hover').removeClass('ibg');
	ajaxController(url,params);		
}
/*function priceSection(obj){ //多选价格段
	var propertyNo="";
	$("input[name='priceSectionCheck']:checkbox").each(function(){ 	 
        if($(this).attr("checked")){
        	propertyNo += ","+$(this).val();  
        }
    })
    if(""!=propertyNo){
    	propertyNo= propertyNo.substring(1);
    }
	$("#prodPriceScope").val(propertyNo); //设置价格段
	
	var priceScopes= prodPriceScopeVal(propertyNo);
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var salesTagNos=$("#salesTagNos").val();   //标签编号
	var queryWord = $("#queryWord").val();     //搜索的词	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	
	
	resetSelection();
	$(obj).parent().find('.sb-bt1').removeClass('xzh');
	$(obj).parent().parent().parent().find('.smore').show();
	$(obj).parent().parent().removeClass('sduox');
	$(obj).parent().parent().find("input[type='checkbox']").removeAttr('checked');
	
	var url='searchCommoByOrder.ihtml';	
	var params='oprtCatNo='+oprtCatNo+'&salesTagNos='+salesTagNos+'&queryWord='+queryWord+'&'+propertyFilters+"&"+priceScopes;
	ajaxController(url,params);		
}*/

function propertyBuutonClick(propertyTypeNo,obj){ //多选属性
	
	var _self = $("span.slir").find(".sb-bt1");
	if(!_self.hasClass("xzh")){
		return;
	}
	var propertyNo="";
	$("input[name='aa"+propertyTypeNo+"']:checkbox").each(function(){ 	 
        if($(this).attr("checked")){
        	propertyNo += ","+$(this).val();  
        }
    });
    if(""!=propertyNo){
    	propertyNo= propertyNo.substring(1);
    }
	
	var propertyTypeResult = "";
	var propertyType=""+$("#propertyType").val(); //属性类别
	if(""==propertyType){
		$("#propertyType").val(propertyTypeNo); //将属性类别赋值给隐藏表单
		propertyTypeResult = propertyTypeNo;
	}else{
		if(propertyType.indexOf(propertyTypeNo)<0){ //判断是否以前已存储
			propertyTypeResult = propertyType+","+propertyTypeNo;
			$("#propertyType").val(propertyTypeResult); //将属性类别赋值给隐藏表单
		}else{
			propertyTypeResult = propertyType;
		}
	}
	$("#"+propertyTypeNo+"Id").val(propertyNo); 
	var propertyFilters= propertyFiltersVal(propertyTypeResult); //获取属性数组
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号

	var queryWord = $("#queryWord").val();     //搜索的词
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+propertyFilters+"&salesTagNos="+salesTagNos;
	
	var priceScopes="";
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	 var reg = /^([1-9]\d*|0)$/;
	 if(""!=minPrice){
		 if(!reg.test(minPrice)) {
			alertBox('最小值应为正整数');
			return ;
		 }
		 priceScopes="priceScopes[0].minPrice="+minPrice;
	}
	if(null!=maxPrice&&""!=maxPrice&&""!=minPrice){
		 if(!reg.test(maxPrice)) {
			 alertBox('最大值应为正整数');
			 return ;
		 }
		priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
	}
	if(""!=priceScopes){
		params = params+ '&'+priceScopes;
	}
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){ //排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	
	ajaxController(url,params);		
}

function propertyAll(propertyTypeNo){ //属性不限

	var propertyTypeResult="";//属性分类
	var propertyType=""+$("#propertyType").val(); //属性类别
	
	if(""!=propertyType){	
	
		if(propertyType==propertyTypeNo){ //隐藏表单域存储一个
			$("#propertyType").val("");
		}else{
			var propertyIndex = propertyType.indexOf(propertyTypeNo);
			
			if(propertyIndex>=0){ //判断是否以前已存储			
				var temp ="";
				if(propertyIndex==0){
					temp = propertyType.replace(propertyTypeNo+",", "");					
				}else{
					temp = propertyType.replace(","+propertyTypeNo, "");
				}
				$("#propertyType").val(temp);
				propertyTypeResult= temp;
			}else{
				propertyTypeResult = propertyType;
			}
		}
		$("#"+propertyTypeNo+"Id").val(""); 
	}
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号

	var queryWord = $("#queryWord").val();     //搜索的词
	//属性值,将属性值拼接成数组对象
	var propertyFilters= propertyFiltersVal(propertyTypeResult); //获取属性数组
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+propertyFilters+"&salesTagNos="+salesTagNos;
	
	var priceScopes="";
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	 var reg = /^([1-9]\d*|0)$/;
	 if(""!=minPrice){
		 if(!reg.test(minPrice)) {
			alertBox('最小值应为正整数');
			return ;
		 }
		 priceScopes="priceScopes[0].minPrice="+minPrice;
	}
	if(null!=maxPrice&&""!=maxPrice&&""!=minPrice){
		 if(!reg.test(maxPrice)) {
			 alertBox('最大值应为正整数');
			 return ;
		 }
		priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
	}
	
	if(""!=priceScopes){
		params = params+ '&'+priceScopes;
	}
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){ //排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	ajaxController(url,params);		
}

function propertyClick(propertyNo,propertyTypeNo,aObj){ //单击属性  propertyNo属性名称  ，propertyNo:属性分类id	

	if($(aObj).parent().parent().parent().hasClass("sduox")){
		return false;
	}
	
	var propertyTypeResult="";//属性分类
	
	//$("#propertyType").val(propertyTypeNo); //将属性类别赋值给隐藏表单
	//$("#"+propertyTypeNo+"Id").val(propertyNo); //选中值赋值给因此表单
	
	/**
	 * 将点击的属性类别，即属性值存储到隐藏表单域中
	 */
	propertyNo= "" +propertyNo;
	propertyTypeNo = "" +propertyTypeNo;
	var propertyType=""+$("#propertyType").val(); //属性类别
	if(""==propertyType){
		$("#propertyType").val(propertyTypeNo); //将属性类别赋值给隐藏表单
		propertyTypeResult = propertyTypeNo;
	}else{
		if(propertyType.indexOf(propertyTypeNo)<0){ //判断是否以前已存储
			propertyTypeResult = propertyType+","+propertyTypeNo;
			$("#propertyType").val(propertyTypeResult); //将属性类别赋值给隐藏表单
		}else{
			propertyTypeResult = propertyType;
		}
	}
	$("#"+propertyTypeNo+"Id").val(propertyNo); 
	var propertyFilters= propertyFiltersVal(propertyTypeResult); //获取属性数组
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var queryWord = $("#queryWord").val();     //搜索的词
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var salesTagNos=$("#salesTagNos").val();
	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+propertyFilters+'&salesTagNos='+salesTagNos;
	
	var priceScopes="";
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	 var reg = /^([1-9]\d*|0)$/;
	 if(null!=minPrice&&""!=minPrice){
		 if(!reg.test(minPrice)) {
			alertBox('最小值应为正整数');
			return ;
		 }
		 priceScopes="priceScopes[0].minPrice="+minPrice;
	}
	if(null!=maxPrice&&""!=maxPrice&&""!=minPrice){
		 if(!reg.test(maxPrice)) {
			 alertBox('最大值应为正整数');
			 return ;
		 }
		priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;	
	}
	if(""!=priceScopes){
		params = params+ '&'+priceScopes;
	}
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType){ //排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType){
			params = params+'&sortType='+sortType;
		}
	}
	ajaxController(url,params);		
	
}

function prodPriceScopeVal(prodPriceScope){ //拼接价格段数组
	
	var prodPriceScopeObj="";
	if(""!=prodPriceScope){
		if(prodPriceScope.indexOf(",")<0){ //当前隐藏表单域中值存了一个价格段
			
			var  priceScopeTextField= $("#"+prodPriceScope).val(); 
			
			var priceScopeArray = priceScopeTextField.split(",");
			prodPriceScopeObj="priceScopes[0].minPrice="+priceScopeArray[0]+"&priceScopes[0].maxPrice="+priceScopeArray[1];
		}else{
			var properyValueItems  =  prodPriceScope.split(",");
			for ( var int = 0; int < properyValueItems.length; int++) {
				var  priceScopeld= $("#"+properyValueItems[i]+"").val();  //得到价格段文本框

				var properyValueItems  =  priceScopeld.split(",");
				prodPriceScopeObj=prodPriceScopeObj+"&priceScopes[0].minPrice="+properyValueItems[0]+"&priceScopes[0].maxPrice="+properyValueItems[1];
			}
		}
	}
	return prodPriceScopeObj;
}
/**
 * 拼属性数组,隐藏表单域中，存储属性分类id值
 */
function propertyFiltersVal(propertyTypeResult){

	//属性值,将属性值拼接成数组对象
	var propertyFilters= "";
	if(""!=propertyTypeResult){
	
		propertyTypeResult = ""+propertyTypeResult;
		
		if(propertyTypeResult.indexOf(",")<0){ //当前隐藏表单域中值存了一个属性类别
			propertyFilters="propertyFilters[0].propNo="+propertyTypeResult;
			
			var properyValues = $("#"+propertyTypeResult+"Id").val(); 
			if(properyValues.indexOf(",")<0){
				var properyValue= new Array();
				properyValue[0]=properyValues;
				propertyFilters=propertyFilters+"&propertyFilters[0].value="+properyValue;
			}else{				
				var properyValueItems  =  properyValues.split(",");
				var properyValue= new Array();
				if(""!=properyValues){
					for ( var k = 0; k < properyValueItems.length; k++) {				
						properyValue[k]=properyValueItems[k];		
					}
				}	
				propertyFilters=propertyFilters+"&propertyFilters[0].value="+properyValue;
			}
		}else{
			var properyTypeItems = propertyTypeResult.split(","); 
			for ( var i = 0; i < properyTypeItems.length; i++) {
				if(i==0){
					propertyFilters=propertyFilters+"propertyFilters["+i+"].propNo="+properyTypeItems[i];
				}else{
					propertyFilters=propertyFilters+"&propertyFilters["+i+"].propNo="+properyTypeItems[i];
				}
				
				var properyValues = $("#"+properyTypeItems[i]+"Id").val(); 
				var properyValueItems  =  properyValues.split(",");
				var properyValue= new Array();
				if(""!=properyValues){
					for ( var k = 0; k < properyValueItems.length; k++) {				
						properyValue[k]=properyValueItems[k];		
					}
				}	
				propertyFilters=propertyFilters+"&propertyFilters["+i+"].value="+properyValue;			
			} 
		}		
	}
	return propertyFilters;
}

function ajaxController(url,params){
	$.ajax({ 
		type: "POST",
	  	url: url,
	  	data: params,
	  	cache: false,
		success: function(msg){
			//清空当前值
			$(".list-comm").empty();
		
	    	var result=eval("("+msg+")");
	    	if(null!=result)
	    	{
	    		var productResult = result.docs;
	    		
	    		if(null!=productResult&&productResult.length>0)
	    		{
	    			for ( var int = 0; int < productResult.length; int++)
	    			{
	    				//待拼接的报文
			        	var str = new StringBuffer("");		        	
			        	
			        	var subTitle= productResult[int].subTitle;
			        	if(null==subTitle)
			        	{
			        		subTitle ="" ;
			        	}
						
						str.append("<div class='item'>");
						str.append(" <a href='javascript:;' onClick='toDetail(\""+productResult[int].defProdNo.trim()+"\")' title='"+productResult[int].title + " " + subTitle +"'>");
						str.append(" <input type='hidden' class='prodDetailNo' value='"+productResult[int].defProdNo+"'>");
						str.append(" <div class='good-img-wrap'>");
						str.append(" <img src='" + MallImgPath + "/" + productResult[int].prodPicUrl +"' alt='' class='good-img'>");
						str.append(" </div> <div class='good-name'> <p class='content'>");
						str.append(" <a href='javascript:void(0)' title='" + productResult[int].title + " " + subTitle +"' onClick='toDetail(\""+productResult[int].defProdNo.trim()+"\")'>");
				        str.append(" " + productResult[int].title + " ");
				        str.append(" <b>"+ subTitle +"</b> </a> </p> </div>");
						str.append(" <div class='good-price'>");	
						str.append(" <span class='discount-price'>&yen;"+productResult[int].price.toFixed(1) +"</span>");
						str.append(" </div></a></div>");
			        	$(".list-comm").append(str.toLocaleString());		        	
					}	    		
	    		}
	    		else
	    		{
	    			$('.no-goods').show();
	    			// $(".list-comm").append("<div style='text-align:center;height: 80px;padding-top: 60px'>未搜索到符合的商品</div>");		
	    		}
	    	}	    	
		}
	});	
}

function oprtCatNoAjax(oprtCatNo,queryWord,obj){
	var _idx = $(".sub-goodss a").index(obj);
	$(".sub-goodss a").removeClass("mred").eq(_idx).addClass("mred");
	$("#oprtCatNo").val(oprtCatNo);               //加载商品列表数据
	//var salesTagNos =queryWord;
	$("#queryWord").val(queryWord);     //搜索的词
	
	//加载商品属性
	var url=MallPath+'/mall/CommodityList/getCommoCatProp.ihtml';	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord;
	getCommoCatProp(url,params);
	
	var url=MallPath+'/mall/CommodityList/searchCommoByOrder.ihtml';	
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord;
	ajaxController(url,params);		
	
}

function getCommoprice(url,params,record){ //价格段加载
	
	$("#commocatePropId").children().filter('li').remove();	//将属性移除
	var str = new StringBuffer("");	
	str.append(record);
	str.append("<li class='clearfix'><span class='slil'>价格段：</span>");
	str.append("<span class='slir mtie7'>");
	str.append("<span class='dsib1'><a class='hover ibg item' href='javascript:void(0)' onClick='unlimitedPrice(this)'>不限</a></span>") ;            
 	str.append("<input type ='text' id='minPrice' class='prce' />--<input id='maxPrice' type ='text' class='prce' />"); 
 	str.append("<div class='ensure-y' onClick='prodPriceClick(this)' style='cursor:pointer'>确定</div>");
 	str.append("</span>");
 	str.append("<div class='clear'></div>");
 	str.append("</li>");     
 
 	$("#commocatePropId").append(str.toLocaleString());	
 	
 	s_101();
}
/**
 * ajax自动加载商品属性
 */
function getCommoCatProp(url,params){
	$.ajax({ 
		type: "POST",
	  	url: url,
	  	data: params,
	  	cache: false,
		success: function(msg){		
		
			var str = new StringBuffer("");	
	    	var result=eval("("+msg+")");	    	
	    	if(null!=result){	    		
	    		for ( var int = 0; int < result.length; int++) {
	    		
	    			str.append("<li class='clearfix' ><span class='slil'>"+result[int].propName+"：</span>");
	    			str.append("<span class='slir'>");
	    			str.append("<div class='divl'><span class='dsib'><a class='item hover' href='javascript:void(0)' title='不限' onclick=\"propertyAll('"+result[int].propNo+"')\">不限</a></span></div>");
	    			if(null!=result[int].commoPropValOptions){
	    				var commoProps = result[int].commoPropValOptions;
	    				str.append("<div class='divr'>");
	    				for ( var int2 = 0; int2 < commoProps.length; int2++) {  
	    					str.append("<span class='dsib'>");
	    					str.append("<input class='ce' type='checkbox' name = 'aa"+result[int].propNo+"' value='"+commoProps[int2].optionNo+"'/>  	");																		
	    					str.append("<a class='item' href='javascript:void(0)' title='" + commoProps[int2].optionName + "' onclick=\"propertyClick('"+commoProps[int2].optionNo+"','"+result[int].propNo+"',this)\"> ");
	    					
	    					str.append(commoProps[int2].optionName+"</a> ");
	    					str.append("</span>");
	    				}
	    				str.append("</div>");
	    			}                              
	    			str.append("<input type='hidden' id='"+result[int].propNo+"Id' value='' />");
	    			str.append("<span class='sear-but'>" );                                            
	    			str.append("<input type='button'  class='sb-bt1' onClick='propertyBuutonClick(\""+result[int].propNo+"\",this)'/>" );
	    			str.append("<input type='button' class='sb-bt2'/>");     
	    			str.append("</span>"); 
	    			str.append("</span>");
	    			str.append("<span class='smore'></span>");
	    			str.append("<span class='gmore'></span>"); 
	    			str.append("<div class='clear'></div>"); 	    			
	    			str.append(" </li>"); 		
				} 		
	    	}
	    	//加载价格段数据
	    	var url1=MallPath+'/mall/CommodityList/getProdPriceSection.ihtml';	
	    	
	    	getCommoprice(url1,params,str);
		}
	});	
}	
function StringBuffer() {
    this.__strings__ = new Array;
}
StringBuffer.prototype.append = function (str) {
   this.__strings__.push(str);
};
StringBuffer.prototype.toString = function () {
   return this.__strings__.join("");
};

var totalPage;


//点击触发该方法
function queryPage(pageNo,id,totalRows,PageSize){
	totalPage=Math.ceil(totalRows/PageSize);
	if(pageNo==0){
		alertBox("已经是第一页!");
		return;
	}
	
	if(pageNo>totalPage){
		alertBox("已经到最后一页!");
		return ;
	}
/*	if(isNaN(pageSize)){
		alertBox('每页条数只能为数字');
		return ;
	}
	var totalPage=Math.ceil(totalRows/pageSize);
	var toPage=pageNo;
	if(pageNo==0){
		//toPage=document.getElementById("query.page").value;
		//if(isNaN(toPage) || toPage<=0){
		//	alertBox("请输入大于0的整数.");
		//	return false;
		//}
		//if(toPage>totalPage){
		//	alertBox("没有当前页数");
		//	return false;
		//}
		return ;
	}
	//校验是跳转页是否在记录有效范围内
	//取大于等于总页数的值
	if(toPage>totalPage){
		alertBox("已经到最后一页");
		return ;
	}*/
	if(id=="pageComent"){
		pageNoClick(pageNo,id); //提供外部调用
	}else{
		pageNo1Click(pageNo,id); //提供外部调用
	}
	
}

function pageFunction(pageNo,rowCount,pageSize,hasPrevious,pageComentId){
	
	//rowCount = rowCount+1;
	//totalRows = rowCount;
	//PageSize = pageSize;
	//将分页控件移除
	$("#"+pageComentId).children().remove();
	
    var pageCount = 1;
    if(rowCount%pageSize==0){
    	pageCount = rowCount/pageSize;
   	}else{
   		pageCount= Math.ceil(rowCount/pageSize);
   	}
	//alertBox(pageCount);
	//return ;
	var pageKongjian = "";
	if(rowCount>0){	
		pageKongjian = pageKongjian + "<a class='toll' >"+pageNo+"/"+pageCount+"</a>";
		if(pageNo==1){
			pageKongjian = pageKongjian + "<a href='javascript:queryPage(1,\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='shoye' id='"+pageComentId+"00'>首页</a>";
		}else{
			pageKongjian = pageKongjian + "<a href='javascript:queryPage(1,\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' id='"+pageComentId+"00'>首页</a>";
		}
		
		if(pageCount>1){
			var pageTempNo= pageCount-pageNo;
			if(hasPrevious == false){
				pageKongjian = pageKongjian + "<span class='page-pre-no'></span>";
			}else{
				var sPageNo = pageNo-1;
				pageKongjian = pageKongjian + "<a href='javascript:queryPage("+sPageNo+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' title='上一页'>上一页</a>";
			}
			if(pageCount<10){
				
				for(var i = 1;i<= pageCount;i++){  	//选中时的样式 
					if(pageNo==i){
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+i+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='shoye' >"+i+"</a>";
					}else{
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+i+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' >"+i+"</a>";
					}
				}
			}else if(pageTempNo<5){
			
				for(var i = 1;i< 10;i++){
					var count = pageCount - 9 + i;
					if((pageCount-pageNo)==(9-i)){//选中时的样式 
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+count+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='shoye'>"+count+"</a>";
					}else{//默认的样式
						
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+count+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'> "+count+"</a>";
					}					
				}
				
			}else{
			
				for(var row = 1;row < 11;row++){
					if(row==8){
						pageKongjian = pageKongjian + "<a>	...</a>";
					}else if(row==9){
						var pageCountTemp = pageCount -1;
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageCountTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'  >"+pageCountTemp+" </a>";
					}else if(row==10){
						pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageCount+",\""+pageComentId+"\")',\""+rowCount+"\",\""+pageSize+"\" > "+pageCount+"</a>";
						
					}else{
						
						if(pageNo < 5){
							
							if(pageNo == row){
								
								pageKongjian = pageKongjian + "<a href='javascript:queryPage("+row+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' class='shoye' > "+row+"</a>";
							}else{
							
								pageKongjian = pageKongjian + "<a href='javascript:queryPage("+row+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' >"+row+"</a>";
							}
						}else {
							var pageNoTemp = pageNo-4+row;
							if(row == 4){
								pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageNoTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='shoye' >"+pageNoTemp+"</a>";
							}else{
								pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageNoTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'> "+pageNoTemp+"</a>";
							}
						}
						
					}				
				}
		
			}
	
		}
		
		if(hasPrevious == false){
			pageKongjian = pageKongjian + "<span class='page-next-no'></span>";
		}else{
			var temp= pageNo +1;
			pageKongjian = pageKongjian + "<a href='javascript:queryPage("+temp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'   title='下一页'  >下一页</a>";
		}
		
		if(pageNo==totalPage){
			pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageCount+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='shoye' id='"+pageComentId+"11' >尾页</a>	";
		}else{
			pageKongjian = pageKongjian + "<a href='javascript:queryPage("+pageCount+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' id='"+pageComentId+"11' >尾页</a>	";
		}
	}else{
		
	}
	
	$("#"+pageComentId).append(pageKongjian);	
	//return pageKongjian;
}

//点击触发该方法--PC改版使用
function queryPageForPCNew(pageNo,id,totalRows,PageSize){
    totalPage = Math.ceil(totalRows/PageSize);
    if(pageNo == 0)
    {
        alert("已经是第一页!");
        return;
    }
    
    if(pageNo > totalPage)
    {
        alert("已经到最后一页!");
        return ;
    }
    pageNoClickForPCNew(pageNo,id);
    // 调用返回商品列表顶部方法
    go_list_top ();
}

function pageFunctionForPCNew(pageNo,rowCount,pageSize,hasPrevious,pageComentId){
    $("#" + pageComentId).children().remove();
    var pageCount = 1;
    var totalPage = Math.ceil(rowCount/pageSize);
    if(rowCount%pageSize == 0)
    {
        pageCount = rowCount/pageSize;
    }else
    {
        pageCount= Math.ceil(rowCount/pageSize);
    }
    var pageKongjian = "";
    if(rowCount > 0)
    {
        if(pageCount > 1)
        {
        	if(pageNo > 1)
            {
        		pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+(pageNo - 1)+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='prev'><span class='go'>&lt;</span> 上一页</a>";
            }
            var pageTempNo = pageCount - pageNo;
            if(pageCount < 10)
            {
                for(var i = 1;i <= pageCount;i++)
                {   //选中时的样式 
                    if(pageNo == i)
                    {
                        pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+i+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='cur' >"+i+"</a>";
                    }else
                    {
                        pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+i+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' >"+i+"</a>";
                    }
                }
            }else if(pageTempNo < 5)
            {
                for(var i = 1;i< 10;i++)
                {
                    var count = pageCount - 9 + i;
                    if((pageCount-pageNo) == (9-i))
                    {//选中时的样式 
                        pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+count+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='cur'>"+count+"</a>";
                    }else
                    {//默认的样式
                    	if(i == 1)
                    	{
                    		pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+i+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' >"+i+"</a>";
                    	}else if(i == 2)
                    	{
                    		pageKongjian = pageKongjian + "<a>  ...</a>";
                    	}else
                    	{
                    		pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+count+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'> "+count+"</a>";
                    	}
                        
                    }                   
                }
            }else
            {
                for(var row = 1;row < 11;row++)
                {
                    if(row == 8)
                    {
                        pageKongjian = pageKongjian + "<a>  ...</a>";
                    }else if(row == 9)
                    {
                        var pageCountTemp = pageCount -1;
                        pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+pageCountTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'  >"+pageCountTemp+" </a>";
                    }else if(row == 10)
                    {
                        pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+pageCount+",\""+pageComentId+"\")',\""+rowCount+"\",\""+pageSize+"\" > "+pageCount+"</a>";
                    }else
                    {
                        if(pageNo < 5)
                        {
                            if(pageNo == row)
                            {
                                pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+row+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' class='cur' > "+row+"</a>";
                            }else
                            {
                                pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+row+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' >"+row+"</a>";
                            }
                        }else 
                        {
                        	if(row == 1)
                        	{
                        		pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+row+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\");' >"+row+"</a>";
                        	}else if(row == 2)
                        	{
                        		pageKongjian = pageKongjian + "<a>  ...</a>";
                        	}else
                        	{
                        		var pageNoTemp = pageNo - 4 + row;
                                if(row == 4)
                                {
                                    pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+pageNoTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='cur' >"+pageNoTemp+"</a>";
                                }else
                                {
                                    pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+pageNoTemp+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")'> "+pageNoTemp+"</a>";
                                }
                        	}
                        }
                    }               
                }
            }
            if(pageNo < totalPage)
            {
            	pageKongjian = pageKongjian + "<a href='javascript:queryPageForPCNew("+(pageNo + 1)+",\""+pageComentId+"\",\""+rowCount+"\",\""+pageSize+"\")' class='next'>下一页 <span class='go'>&gt;</span></a>";
            }
        }else
        {
        	pageKongjian = pageKongjian + "<a href='javascript:;' class='cur'>1</a>";
        }
    }else
    {
        
    }
    $("#"+pageComentId).append(pageKongjian);   
}

function pageNoClickForPCNew(pageNo,id){
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var queryWord = $("#queryWord").val();     //搜索的词
	
	var prodPriceScope=$("#prodPriceScope").val(); //获取价格段
	var priceScopes= prodPriceScopeVal(prodPriceScope);
	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	var salesTagNos=$("#salesTagNos").val();
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+priceScopes+'&'+propertyFilters+"&salesTagNos="+salesTagNos;
	
	if(""!=orderType)
	{
		//排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType)
		{
			params = params+'&sortType='+sortType;
		}
	}
	
    var url = MallPath + "/mall/CommodityList/getCommodityListForPage.ihtml";
    params = params + '&page=' + pageNo;
    
    $.ajax({ 
        type: "POST",
        url: url,
        data: params,
        success: function(msg){
            $("#listComm").children().remove();
            var result=eval("("+msg+")");
            if(null!=result)
            {
                var item = result.docs;
                pageFunctionForPCNew(result.curPageNo,result.total,result.recsPerPage,true,id);
                if(item == "")
                {
                    //将分页控件移除
                    //$("#pageComent").children().remove(); 
                    $('.no-goods').show();
                    /*var str = "<div style=\"text-align:center;height: 80px;padding-top: 60px\">未搜索到符合的商品</div>";
                    $("#listComm").append(str);*/
                }else
                {
                    for(var i = 0;i < item.length;i++)
                    {
                    	var str = new StringBuffer("");
                        str.append("<div class=\"item\">");
                        str.append("<a href=\"javascript:;\" onClick=\"toDetail('" + item[i].defProdNo+ "')\" title=\"" + item[i].title + " " + (item[i].subTitle == undefined ? "" : item[i].subTitle) + "\">");
                        str.append("<input type=\"hidden\" class=\"prodDetailNo\" value=\"" + item[i].defProdNo + "\">");
                        if(item[i].isNewly == "1")
                        {
                        	str.append("<div class=\"tag\">新品</div>");
                        }
                        str.append("<div class=\"good-img-wrap\">");
                        str.append("<img src=\"" + MallImgPath + "/" + item[i].prodPicUrl + "\" alt=\"\" class=\"good-img\">");
                        str.append("</div>");
                        str.append("<div class=\"good-name\">");
                        str.append("<p class=\"content\">");
                        if(item[i].title != undefined)
                        {
                        	str.append(item[i].title);
                        }
                        if(item[i].subTitle != undefined)
                        {
                        	str.append("<b>" + item[i].subTitle + "</b>");
                        }
                        str.append("</p></div>");
                        str.append("<div class=\"good-price\">");
                        str.append("<span class=\"discount-price\">&yen;" + item[i].price + "</span>");
                        str.append("<span class=\"original-price hide\">¥188.0</span>");
                        str.append("</div>");
                        str.append("<div class=\"bottom-tip hide\">");
                        str.append("<p class=\"low-stocks\">库存不足</p>");
                        str.append("<p class=\"time-discount\">");
                        str.append("仅 <span>¥88.0</span>限时优惠中 &gt;");
                        str.append("</p></div></a></div>");
                        
                        $("#listComm").append(str.toLocaleString());
                    }
                }
            }
        }
    });
}

/**
* 排序方式--PC改版使用，新增分页特性
 */
function commodOrderForPCNew(orderType,aFiled){
	var propertyFilters = $("#commodOrder").val(); //排序方式
	if(""!=orderType)
	{
		//如果选中综合排序
		if(propertyFilters==orderType)
		{
			//当前点击的怕排序方式，跟上次相同，则不请求数据			
			var aSpan = $(aFiled).find("span");
			if(aSpan.hasClass("uparrow1"))
			{
				aSpan.removeClass("uparrow1").addClass("downarrow");
			}
			else
			{
				aSpan.removeClass("downarrow").addClass("uparrow1");
			}
		}
		else
		{
			$(".sub-pax .xl").find(".hover").removeClass("hover").find("span").removeClass("uparrow1").removeClass("downarrow").addClass("uparrow");  
			$(aFiled).addClass("hover");
			$(aFiled).find("span").removeClass("uparrow").addClass("uparrow1");
		}		
		var sortTyoe = $(aFiled).find("span").attr("class");
		if(sortTyoe=="uparrow1")
		{
			//降序
			$("#sortType").val("desc");
		}
		else
		{
			//升序
			$("#sortType").val("asc");
		}
	}
	else
	{
		$(".sub-pax .xl").find(".hover").removeClass("hover").find("span").removeClass("uparrow1").removeClass("downarrow").addClass("uparrow");  
		$(aFiled).addClass("hover");
		$(aFiled).find("span").removeClass("uparrow").addClass("uparrow1");	
		$("#sortType").val("");
	}
	
	$("#commodOrder").val(orderType);
	var oprtCatNo=$("#oprtCatNo").val();     //分类编号
	var queryWord = $("#queryWord").val();     //搜索的词
	
	var prodPriceScope=$("#prodPriceScope").val(); //获取价格段
	var priceScopes= prodPriceScopeVal(prodPriceScope);
	
	var propertyType=""+$("#propertyType").val(); //属性类别
	var propertyFilters = propertyFiltersVal(propertyType);
	var salesTagNos=$("#salesTagNos").val();
	var url = MallPath + '/mall/CommodityList/getCommodityListForPage.ihtml';
	var params='oprtCatNo='+oprtCatNo+'&queryWord='+queryWord+'&'+priceScopes+'&'+propertyFilters+"&salesTagNos="+salesTagNos;
	
	var sortType = $("#sortType").val(); //排序方式,升序还是降序排序
	var orderType = $("#commodOrder").val();
	
	if(""!=orderType)
	{
		//排序方式
		params = params+'&prodSortField='+orderType;
		if(""!=sortType)
		{
			params = params+'&sortType='+sortType;
		}
	}
	var priceScopes="";
	var minPrice=$("#minPrice").val();     //最小值
	var maxPrice=$("#maxPrice").val();     //最大值
	var reg = /^([1-9]\d*|0)$/;
	if(null!=minPrice&&""!=minPrice)
	{
		if(!reg.test(minPrice))
		{
			alertBox('最小值应为正整数');
			return ;
		}
		priceScopes="priceScopes[0].minPrice="+minPrice;
	}
	
	if(null!=maxPrice&&""!=maxPrice&&""!=minPrice)
	{
		 if(!reg.test(maxPrice))
		 {
			 alertBox('最大值应为正整数');
			 return ;
		 }
		priceScopes=priceScopes+"&priceScopes[0].maxPrice="+maxPrice;
	}
	
	if(""!=priceScopes)
	{
		params = params+ '&'+priceScopes;
	}
	ajaxControllerForPCNew(url,params);
}

/**
 * PC改版使用
 * @param url
 * @param params
 */
function ajaxControllerForPCNew(url,params){
	$.ajax({ 
		type: "POST",
	  	url: url,
	  	data: params,
	  	cache: false,
		success: function(msg){
			//清空当前值
			$("#listComm").empty();
	    	var result=eval("("+msg+")");
	    	if(null!=result)
	    	{
	    		pageFunctionForPCNew(result.curPageNo,result.total,result.recsPerPage,true,"listCommPage");
	    		var productResult = result.docs;
	    		if(null!=productResult&&productResult.length>0)
	    		{
	    			for ( var int = 0; int < productResult.length; int++)
	    			{
	    				//待拼接的报文
			        	var str = new StringBuffer("");
			        	var subTitle= productResult[int].subTitle;
			        	if(null == subTitle || subTitle == undefined)
			        	{
			        		subTitle ="" ;
			        	}
						
			        	var str = new StringBuffer("");
                        str.append("<div class=\"item\">");
                        str.append("<a href=\"javascript:;\" onClick=\"toDetail('" + productResult[int].defProdNo+ "')\" title=\"" + productResult[int].title + " " + subTitle + "\">");
                        str.append("<input type=\"hidden\" class=\"prodDetailNo\" value=\"" + productResult[int].defProdNo + "\">");
                        str.append("<div class=\"tag hide\">新品</div>");
                        str.append("<div class=\"good-img-wrap\">");
                        str.append("<img src=\"" + MallImgPath + "/" + productResult[int].prodPicUrl + "\" alt=\"\" class=\"good-img\">");
                        str.append("</div>");
                        str.append("<div class=\"good-name\">");
                        str.append("<p class=\"content\">");
                        if(productResult[int].title != undefined)
                        {
                        	str.append(productResult[int].title);
                        }
                        str.append("<b>" + subTitle + "</b>");
                        str.append("</p></div>");
                        str.append("<div class=\"good-price\">");
                        str.append("<span class=\"discount-price\">&yen;" + productResult[int].price + "</span>");
                        str.append("<span class=\"original-price hide\">¥188.0</span>");
                        str.append("</div>");
                        str.append("<div class=\"bottom-tip hide\">");
                        str.append("<p class=\"low-stocks\">库存不足</p>");
                        str.append("<p class=\"time-discount\">");
                        str.append("仅 <span>¥88.0</span>限时优惠中 &gt;");
                        str.append("</p></div></a></div>");
			        	$("#listComm").append(str.toLocaleString());		        	
					}	    		
	    		}
	    		else
	    		{
	    			$('.no-goods').show();
	    			// $("#listComm").append("<div style='text-align:center;height: 80px;padding-top: 60px'>未搜索到符合的商品</div>");		
	    		}
	    	}	    	
		}
	});	
}